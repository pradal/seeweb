{% from 'templates/project/macro.jinja2' import project_condensed with context %}

{% extends "layout_view.jinja2" %}

{% block user_view_body -%}

<div class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Owned</h3>
  </div>
  <div class="panel-body">
    {% if allow_edit %}
        <div class="row">
            <div class="col-md-12">
                <form action="{{ request.current_route_url() }}" method='POST'>
                    <div class="form-group">
                        <a class="btn btn-primary pull-right" href="{{ request.route_url('site_suck') }}">Clone</a>
                        <a class="btn btn-primary pull-right" href="{{ request.route_url('file_suck') }}">Single File</a>
                        <button class="btn btn-primary" type="submit" name="new_project">Create</button>
                        <input type='text' name='project_id' placeholder='new project id' />
                    </div>
                </form>
            </div>
        </div>
    {% endif %}
    {% if projects|length == 0 %}
        {% if allow_edit %}
        <p>None yet. Create one?</p>
        {% else %}
        <p>This user has no public project.</p>
        {% endif %}
    {% else %}
        <div class="row">
            {% for role, project in projects %}
                {{ project_condensed(project, role) }}
            {% endfor %}
        </div>
    {% endif %}
  </div>
</div>

{% if user.id == request.unauthenticated_userid %}
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Installed</h3>
      </div>
      <div class="panel-body">
        {% if installed_projects|length == 0 %}
            <div class="row">
                <p>Nothing installed yet.</p>
            </div>
        {% else %}
            <div class="container-fluid">
                <div class="row">
                    {% for role, project in installed_projects %}
                        {{ project_condensed(project, role) }}
                    {% endfor %}
                </div>
            </div>
        {% endif %}
      </div>
    </div>
{% endif %}

{%- endblock %}
